<h2 id="bip-4---dynamic-client-ui-(dynclientui)---not-implemented">BIP 4 - Dynamic Client UI (DynClientUI) - Not implemented <a class="header-anchor" href="#bip-4---dynamic-client-ui-(dynclientui)---not-implemented" aria-hidden="true">§</a></h2>
<p>This module enables scripts to completely control the user interface on the clients. This can be used to easily enable new scripts who needs a good control over user interaction. The module needs three important functionalities:</p>
<ol>
<li>
<p>It must be able to push GUI elements to the client engine which are then displayed.</p>
</li>
<li>
<p>It must have the ability to later control these elements with data updates.</p>
</li>
<li>
<p>It must provide a back channel so the user can click buttons or enter text input.</p>
</li>
<li>
<p>Optionally: It should be able to translate the UI into all the supported languages by the Bestia game.</p>
</li>
</ol>
<h3 id="technical-details">Technical details <a class="header-anchor" href="#technical-details" aria-hidden="true">§</a></h3>
<p>The UI components should be implemented as HTML snippets similar to the GUI elements. The engine can load and display them on demand by specifying an ID. KnockoutJS can be used to bind the data model to the UI.</p>
<p>By creating such a user UI a script should generate a UUID since we must uniquely identify the UI element the user is interacting with.</p>
<p>Before the data is sent to the user a scriptRemoteUId is generated. This is basically a UID which maps to a script component id and entity id. This is important so the script IDs are hidden from the client and the data send back from him has no way to guess a script id and send spoofed data towards it.</p>
<h4 id="data-updates">Data Updates <a class="header-anchor" href="#data-updates" aria-hidden="true">§</a></h4>
<p>In order for the script to update the data to the user it just sends a gui request message again with a updates data section (as seen in the examples). The client will only update the data model if the GUI with the associated uuid is already active.</p>
<h4 id="user-control">User Control <a class="header-anchor" href="#user-control" aria-hidden="true">§</a></h4>
<p>If the user interacts with the model, changes the data the GUI should either send the data on every change or via some kind of user triggered event (e.g. like closing the UI, clicking a &quot;send&quot; button). How to trigger the data transfer is up to the UI code. The whole data model is then transferred back to the server. Since this data comes from the client the script is not directly fed with the data. The script remote uid is translated back towards a component and script id and then the JSON data should be sanitized and send back to the script into a callback. See: <a href="https://stackoverflow.com/questions/9676423/how-to-pass-json-object-from-java-to-javascript">https://stackoverflow.com/questions/9676423/how-to-pass-json-object-from-java-to-javascript</a></p>
<p>The script callback is determined by the script if the data is sent to the user and must be saved on the server side.</p>
<p>There should also be an easy API call to clean up all resources on the server the script-client communication did consume. If there is no interaction with the client for some time (maybe some minutes) the server resources should be freed automatically.</p>
<h4 id="translation">Translation <a class="header-anchor" href="#translation" aria-hidden="true">§</a></h4>
<p>For the alpha status of the game no translation is performed. The implementation is done in english. Translation facilities have to discussed for a later time.</p>
<h3 id="dataformat">Dataformat <a class="header-anchor" href="#dataformat" aria-hidden="true">§</a></h3>
<h3 id="gui-request-message">GUI request message <a class="header-anchor" href="#gui-request-message" aria-hidden="true">§</a></h3>
<p>{</p>
<p>&quot;uuid&quot;: “XXXXXXXX” // String</p>
<p>&quot;scriptRemoteUid&quot;: “XXXXXXX” // String, ID of the script instance responsible.</p>
<pre><code>&quot;guiElement&quot;: “myGUI” // String, ID which GUI element to load.

&quot;data&quot;: {...} // Arbitrary data depending on the script.
</code></pre>
<p>}</p>
