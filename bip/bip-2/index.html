<h2 id="bip-2---latency-estimation---partly-implemented">BIP 2 - Latency estimation - partly implemented <a class="header-anchor" href="#bip-2---latency-estimation---partly-implemented" aria-hidden="true">§</a></h2>
<p>Um dem Spieler ein möglichst synchrones Spielerlebnis zu gewährleisten ist es wichtig die Latenz der Spieler untereinander zu kennen um so zum Beispiel Laufwege zu realisieren die zum gleichen Zeitpunkt enden. Dafür ist es wichtig die aktuelle Latenz des Spielers zum Server zu kennen. Zu diesem Zweck sendet der Server in regelmäßigen Zeitabständen einen PingRequest, mit einer ID und einem Timestamp, an den Client. Dieser antwortet darauf mit einem PingAnswer und dieser ID. Der Server kann dann zusammen mit der Ankunftszeit dieses Paketes die Latenz zu diesem Client abschätzen.</p>
<p>Diese Pakete werden alle 10 Sekunden gesendet und es wird ein Sliding Average der Ping Werte über 5 Messungen gebildet. Dabei wird der Median gebildet. Das Ergebnis nutzt man um alle Events zu korrigieren die eine gewisse Dauer in Anspruch nehmen. Dies sind vor allem Laufevents und Animationen über eine bestimmte Dauer (Zauber).</p>
<p>Zur Korrektur wird die ursprüngliche Animationsdauer um die Latenzzeit subtrahiert. All messages denoting a duration should also contain the latency estimation value.</p>
<p>Siehe: <a href="http://www.dynetisgames.com/2017/03/19/latency-estimation-phaser-quest/">http://www.dynetisgames.com/2017/03/19/latency-estimation-phaser-quest/</a></p>
