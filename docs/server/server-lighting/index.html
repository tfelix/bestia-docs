<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lighting | Bestia Game</title>


<link rel="stylesheet" href="/book.min.45f3004d3c562c29285b27831e8a758ba54606954e3732ff376275b2c2d98616.css" integrity="sha256-RfMATTxWLCkoWyeDHop1i6VGBpVONzL/N2J1ssLZhhY=">


<script defer src="/search.min.8579bb6ad7124bdf2c65fad5e95713d8da0c847668d7b5cacd1d515d472852ec.js" integrity="sha256-hXm7atcSS98sZfrV6VcT2NoMhHZo17XKzR1RXUcoUuw="></script>



<link rel="icon" href="/favicon.png" type="image/x-icon">


<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://docs.bestia-game.net"><img src="/bestia-logo.svg" alt="Logo" /></a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    

  
  





 
  
    

  <ul>
    
      
        

  <li >
    
      

  <a href="/docs/mechanics/" >
      Game Design
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/mechanics/core-guidelines/" >
      Core Concepts
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/archivements/" >
      Archivements
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/spells/" >
      Attacks
  </a>

</li>
      
    
      
        

  <li >
    
      <span>Bestia</span>
    

    

  <ul>
    
      
        <li>

  <a href="/docs/mechanics/bestia/master/" >
      Bestia Master
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/bestia/breeding/" >
      Bestia Breeding
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/bestia/statusvalues/" >
      Status Values
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        <li>

  <a href="/docs/mechanics/time/" >
      Bestia Time
  </a>

</li>
      
    
      
        

  <li >
    
      

  <a href="/docs/mechanics/crafting/" >
      Crafting
  </a>


    

    

  <ul>
    
      
        <li>

  <a href="/docs/mechanics/crafting/alchemy/" >
      Alchemy
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        <li>

  <a href="/docs/mechanics/honor/" >
      Honor
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/inventory/" >
      Inventory
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/items/" >
      Items
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/quests/" >
      Quests
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/resources/" >
      Resources
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/skills/" >
      Skills
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/story/" >
      Story
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/cults/" >
      The Cults
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/trading/" >
      Trading
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/weather/" >
      Weather
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/exploration/" >
      World Exploration
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/resources/artwork/" >
      Artwork and Design
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/mechanics/resources/literature/" >
      Literature
  </a>

</li>
      
    
  </ul>


  </li>


      
    
      
        <li>

  <a href="/docs/api/" >
      API
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/client/client-architecture/" >
      Client
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/bip/" >
      Improvement Proposals
  </a>

</li>
      
    
      
        

  <li >
    
      <span>Server</span>
    

    

  <ul>
    
      
        <li>

  <a href="/docs/server/server-datatypes/" >
      Server Datatypes
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/ai/" >
      Artificial Intelligence
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-battlesystem/" >
      Battlesystem
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-environment/" >
      Environment
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-lighting/"  class="active">
      Lighting
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-routing/" >
      Routing
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-architecture/" >
      Server Architecture
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-scripts/" >
      Server Scripts
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-datastreaming/" >
      Server Streaming
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-narrativegeneration/" >
      Stories and Quests Generation
  </a>

</li>
      
    
      
        <li>

  <a href="/docs/server/server-worldcreation/" >
      World Generation
  </a>

</li>
      
    
  </ul>


  </li>


      
    
  </ul>


  











</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" alt="Menu" />
  </label>
  <strong>Lighting</strong>
</header>

      
<article class="markdown"><p>Gruppen Renderlayer</p>

<p>ground
objects
sprites
effects
overlay
gui</p>

<p>Gruppenmanager? Der entsprechende Render-Layer definiert und verwaltet?
Lichtsystem
Lichtinformation wird auf dem Server benötigt Tile basiert.
Licht information wird auf dem Client benötigt, Tile basiert</p>

<p>Licht wird global in groben Chunks abgelegt.
Darüber hinaus werden Entities im System gespeichert welche Licht emmitieren.
Aus beiden wird eine Lightmap berechnet die in einer effizienten Codierung die Light Map in einem Dateiformat ablegen und an den Client senden
Der Client regeneriert diese Lightmap und rendert daraus eine Textur, die dann mit der Karte überlagert wird.</p>

<p>Es gibt eine Lightmap die mit einem Multiply über die restlichen Layer gelegt wird. Diese Lightmap wird in der Regel mit jedem neuen Update neu gezeichnet → dynamische Lichteffekte (flackern), Attacken.</p>

<p>Wie wird die Umgebung aufgehellt? Add-Layer? Der eine gewisse Grundhelligkeit erzeugt (von Lichtquellen gesteuert). Das Wettersystem z.B. kann diesen Layer beeinflussen. Tag und Nacht auch. Manche Maps besitzen auch einen statischen Helligkeitswert (Dungeons und Höhlen zum Beispiel).</p>

<p>Damit ein Objekt zur Lichtberechnung beiträgt muss es mit dem Licht-Trait ausgestattet sein. Dieser enthält und liefert folgende Informationen:</p>

<p>Lichtfarbe
Lichthelligkeit
Falloff → Normalerweise 1/r² (faked)</p>

<p>Das System muss dem Licht Trait die Tickzeit (abklingender Lichteffekt etc.) beim Abfragen der Informationen zur Verfügung stellen.</p>

<p>Blend Modes
PIXI.blendModes = { NORMAL:0, ADD:1, MULTIPLY:2, SCREEN:3, OVERLAY:4, DARKEN:5, LIGHTEN:6, COLOR_DODGE:7, COLOR_BURN:8, HARD_LIGHT:9, SOFT_LIGHT:10, DIFFERENCE:11, EXCLUSION:12, HUE:13, SATURATION:14, COLOR:15, LUMINOSITY:16 };
ggf. Color Dodge oder Add</p>

<p>zum Aufhellen der Umgebung ggf. einen der beiden Layer mit gewissem Alpha addieren.</p>

<p>Die Helligkeit und der Falloff bestimmen die Reichweite. Dieser Layer wird multipliziert mit den darunterliegenden Layern.</p>

<p>Ggf wird ein weiterer Layer für die Farbinformation benötigt um ein schönes Blending zu erziehlen.</p>

<p>Lichtsystem implementieren
Admin Chat Commands die das Licht setzen können
Dynamisches System das das globale Licht auf der Welt steuert, abhängig von der Tageszeit
Tageszeit Klasse die, abhängig von der Serverzeit, den Tag in 0 - 1 float abbildet, auch das Jahr sollte auch 0 bis 1 gemappt werden. Aktuelle Jahreszeiten sind per Enum zu liefern. (Spring, Summer, Autumn, Winter)
Lokale Lichtquellen vorsehen. Entities mit einer Component. Diese sollten so eine Ausdehnung (Bounding Box) besitzen, dass ihre Lichtreichweite abgedeckt wird.
Das System berechnet bei Änderung die Lichter neu und sendet sie an die Clients.
Übliche Periode für Lichtberechnung: Minuten.
LightEntityFactory implementieren</p>
</article>

      
<div class="book-footer justify-between">
  
  <div>
    
    <a href="https://github.com/tfelix/bestia-docs/commit/ad79b32f9a8f8e4bdaebcf1d4cf1790076508002" title='Last modified Sep 16, 2019 by Thomas Felix' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" alt="Changed" /> Sep 16, 2019
    </a>
  </div>
  
  
  <div>
    <a href="https://github.com/tfelix/bestia-docs/edit/master/content/docs/server/server-lighting.md" target="_blank" rel="noopener">
      <img src="/svg/edit.svg" alt="Edit" /> Edit this page
    </a>
  </div>
  
</div>


      
    </div>

    
  



  </main>

  
  
</body>

</html>
